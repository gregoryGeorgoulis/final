<script type="text/javascript">
	$(document).ready(function() {

		var toggleButton = function() {
			$("#button").click(function() {
			if ($("#button").hasClass("bar")) {
				$("#button.bar").toggleClass("pie");
				daJax();
				} 
			})
		}
		
		var daJax = function(){
			var numData = [];
			var numData2 = [];
			var numData3 = [];
			var numData4 = [];
			var nameData = [];
			var nameData2 = [];
			var nameData3 = [];
			var nameData4 = [];
			$.ajax({
				url: "/states/polster",
				method: "GET",
				dataType: 'json',
				success: function(data) {
					$("#container").empty();
					console.log(data);
					/// this is name
					data[9].questions[0].subpopulations[0].responses.forEach(function(data) 
					{ nameData.push(data.choice); });
					// data[9].questions[0].subpopulations[1].responses.forEach(function(data) 
					// { nameData2.push(data.choice); });
					// data[9].questions[0].subpopulations[2].responses.forEach(function(data) 
					// { nameData3.push(data.choice); });
					//// this is nums
					data[9].questions[0].subpopulations[0].responses.forEach(function(data) 
					{ numData.push(data.value) });
					// data[9].questions[0].subpopulations[1].responses.forEach(function(data) 
					// { numData2.push(data.value) });
					// data[9].questions[0].subpopulations[2].responses.forEach(function(data) 
					// { numData3.push(data.value) });
					///////// this is label 
					label1 = data[9].questions[0].subpopulations[0].name
					// label2 = data[9].questions[0].subpopulations[1].name
					// label3 = data[9].questions[0].subpopulations[2].name

					if ($("#button").hasClass("bar pie")) {
						createPie(numData, label1, nameData);
						// createPie(numData2, label2, nameData2);
						// createPie(numData3, label3, nameData3);
					} else {
						createGraph(numData, label1, nameData);
						// createGraph(numData2, label2, nameData2)
						// createGraph(numData3, label3, nameData3)
					}
				}
			});
		}
		

		
		var createGraph = function(theData, label, name) {
			var margin = {top: 20, right: 10, bottom: 20, left: 10};
			var width = 450;
			var height = 300;

			var widthScale = 
				d3.scaleLinear()
					.domain([0, 100])
					.range([0, width]);

			var color = 
				d3.scaleLinear()
				.domain([0, 100])
				.range(["green", "yellow"]);

			var axis = 
				d3.axisBottom()
					.scale(widthScale);

			var canvas = 
			d3.select("#container")
				.append("div")
				.attr("class","graph")
				.append("svg")
				.attr("width", width)
				.attr("height", height)
				.append("g")
				.attr("transform", "translate(20, 50)");

			canvas.selectAll("text")
			.data(theData)
			.enter()
			.append("text")
	    .text(function(d) { return d; })	
	    .attr("x",function(d) { return widthScale(d); })
	    .attr("y",function(d, i) { return (i * 30) + 15 ; });

	    canvas.selectAll("g")
			.data(name)
			.enter()
	    .append("text")
	    .text(function(d) { return d; })
	    .data(theData)	
	    .attr("x",function(d) { return widthScale(d) + 20; })
	    .attr("y",function(d, i) { return (i * 30) + 15 ; });

			var bars = 
			canvas.selectAll("rect")
				.data(theData)
				.enter()
					.append("rect")
					.attr("width", function(d) { return 0 })
					.attr("height", 20)
					.attr("fill", function(d) { return color(d) })
					.attr("y", function(d, i) { return i * 30 })


			bars.transition()
				.duration(1500)
				.attr("width",function(d) { return widthScale(d) })

			canvas.append("text")
				.attr("x", (width / 2))             
	      .attr("y", 0 - (margin.top / 2))
	      .attr("text-anchor", "middle")  
	      .style("font-size", "16px") 
	      .style("text-decoration", "underline")  
	      .text(label);

			canvas.append("g")
				.attr("transform", "translate(0, 200)")
				.call(axis);

			var shape = d3.symbolStar();

			canvas.append()

		}

		var createPie = function(theData, label, name) {
			var r = 150;

			var color =
				d3.scaleOrdinal()
					// .domain([0, 100])
					.range([ "green", "orange","red","blue","pink","yellow","brown" ]);

			var canvas = 
				d3.select("#container").append("svg")
					.attr("width", 900)
					.attr("height", 400);

			var group =
				canvas.append("g")
					.attr("transform", "translate(200, 200)");

			var arc = 
				d3.arc()
					.innerRadius(100)
					.outerRadius(r);

			var pie =
				d3.pie()
				.value(function(d) { return d; });

			var arcs =
				group.selectAll("arc")
				.data(pie(theData))
				.enter()
				.append("g")
				.attr("class", "arc");

			arcs.append("path")
				.attr("d", arc)
				.attr("fill", function(d) { return color(d.data); });

			arcs.append("text")
				.attr("transform", function(d) { return "translate(" + arc.centroid(d) + ")"; })
				.text(function(d) { return d.data; });
		};

		daJax();
		toggleButton();
	});
</script>





































